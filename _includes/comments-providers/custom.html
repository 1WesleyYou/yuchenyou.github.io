<!-- start custom comments snippet: Utterances --> 
<div id="utterances_thread"></div>
<script>
        (function() {
                var container = document.getElementById('utterances_thread');
                if (!container) return;

                var DEBUG = false;
                function log() { if (DEBUG && window.console) console.log.apply(console, arguments); }

                // Resolve repo from config; fall back to literal value if empty
                var repo = '{{ site.repository | escape }}'.trim();
                if (!repo) { repo = '1Wesleyyou/yuchenyou.github.io'; }

                function currentTheme() {
                        return (document.documentElement.getAttribute('data-theme') === 'dark') ? 'github-dark' : 'github-light';
                }

                function inject() {
                        container.innerHTML = '';
                        var s = document.createElement('script');
                        s.src = 'https://utteranc.es/client.js';
                        s.async = true;
                        s.setAttribute('repo', repo);
                        // Use full URL mapping to reduceÂ≠êË∑ØÂæÑÂØºËá¥ÁöÑ‰∏çÂåπÈÖç
                        s.setAttribute('issue-term', 'url');
                        s.setAttribute('label', 'üí¨ comment');
                        s.setAttribute('theme', currentTheme());
                        s.crossOrigin = 'anonymous';
                        container.appendChild(s);
                        log('[utterances] injected', { repo: repo, url: location.href, theme: currentTheme() });
                }

                function hasIframe() {
                        return !!document.querySelector('iframe.utterances-frame');
                }

                // initial mount
                inject();

                // simple retry if iframe not mounted (network/CSP/Âª∂Ëøü)
                var attempts = 0;
                function ensureMounted() {
                        if (hasIframe()) return;
                        if (++attempts <= 2) {
                                log('[utterances] no iframe yet, retry', attempts);
                                inject();
                                setTimeout(ensureMounted, 2500);
                        } else {
                                if (!hasIframe()) {
                                        container.innerHTML = '<p style="font-size:0.9em;color:var(--global-text-color-light)">Failed to load comments. Ensure the Utterances GitHub App is installed for <code>'+repo+'</code> and that your browser or CSP does not block <code>https://utteranc.es</code>.</p>';
                                }
                        }
                }
                setTimeout(ensureMounted, 2500);

                // react to theme changes
                var obs = new MutationObserver(function(mutations) {
                        for (var i = 0; i < mutations.length; i++) {
                                if (mutations[i].attributeName === 'data-theme') {
                                        var iframe = document.querySelector('iframe.utterances-frame');
                                        if (!iframe) { inject(); return; }
                                        iframe.contentWindow.postMessage({ type: 'set-theme', theme: currentTheme() }, 'https://utteranc.es');
                                        log('[utterances] theme switched');
                                }
                        }
                });
                obs.observe(document.documentElement, { attributes: true, attributeFilter: ['data-theme'] });
        })();
</script>
<!-- end custom comments snippet -->